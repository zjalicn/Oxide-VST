<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="./global.css" />
  </head>
  <body>
    <div class="header">
      <div class="title">Oxide</div>
      <div class="preset-container">
        <div class="preset-label">Preset:</div>
        <select
          class="preset-dropdown"
          id="presetDropdown"
          onfocus="this.blur();"
        >
          <option value="default">Default</option>
          <option value="light_drive">Light Drive</option>
          <option value="heavy_metal">Heavy Metal</option>
          <option value="fuzz">Fuzz</option>
          <option value="warm_tape">Warm Tape</option>
        </select>
      </div>
      <button class="save-button" id="saveButton">Save</button>
    </div>

    <script>
      // Get references to our UI elements
      const presetDropdown = document.getElementById("presetDropdown");
      const saveButton = document.getElementById("saveButton");

      // Prevent focus on dropdown
      document.addEventListener("mousedown", function (e) {
        if (e.target.tagName === "SELECT") {
          e.preventDefault();

          // Show dropdown manually
          var event = document.createEvent("MouseEvents");
          event.initMouseEvent(
            "mousedown",
            true,
            true,
            window,
            0,
            0,
            0,
            0,
            0,
            false,
            false,
            false,
            false,
            0,
            null
          );
          e.target.dispatchEvent(event);
        }
      });

      presetDropdown.addEventListener("change", function () {
        const presetName = this.value;
        // Use the oxide: URL scheme to communicate with C++
        window.location.href = "oxide:preset=" + presetName;

        // Immediately blur to prevent focus issues
        this.blur();
      });

      // Handle save button click
      saveButton.addEventListener("click", function () {
        // Use the oxide: URL scheme to communicate with C++
        window.location.href = "oxide:action=save";
      });
    </script>
  </body>
</html>
